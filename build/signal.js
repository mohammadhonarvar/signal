globalThis.Alwatr==null&&(globalThis.Alwatr={registeredList:[]});try{_ALWATR_VERSION_}catch(e){globalThis._ALWATR_VERSION_="ERROR",console.warn("!! SCRIPTS LOADED OUTSIDE OF ALWATR BUILD ENVIRONMENT !!")}Alwatr.registeredList==null&&(Alwatr.registeredList=[]);var x=Alwatr;x.registeredList.push({name:"@alwatr/logger",version:_ALWATR_VERSION_});var b=typeof process!="undefined",y,S=b?process.env.ALWATR_DEBUG==="1":((y=globalThis.localStorage)==null?void 0:y.getItem("alwatrDebug"))==="1",E=b?["0;36","0;35","0;34","0;33","0;32"]:["#35b997","#f05561","#ee224a","#91c13e","#22af4b","#f0e995","#0fe995","#0f89ca","#08b9a5","#fee851","#ee573d","#f9df30","#1da2dc","#f05123","#ee2524"],m=0,_=()=>{let e=E[m];return m++,m>=E.length&&(m=0),e},i={scope:b?"\x1B[{{color}}m":"color: {{color}};",reset:b?"\x1B[0m":"color: inherit;"},T=b?"%s%s%s":"%c%s%c",C=e=>{e=e.trim();let r=e.charAt(0);return r!=="["&&r!=="{"&&r!=="<"&&(e="["+e+"]"),e},h=(e,r=S)=>{let t=_(),n=i.scope.replaceAll("{{color}}",t);e=C(e);let s={devMode:r,domain:e,accident:b?console.warn.bind(console,`${n}⚠️
%s\x1B[33m.%s() Accident \`%s\` %s!${i.reset}`,e):console.warn.bind(console,"%c%s%c.%s() Accident `%s` %s!",n,e,i.reset),error:b?console.error.bind(console,`${n}❌
%s\x1B[31m.%s() Error \`%s\`${i.reset}
`,e):console.error.bind(console,"%c%s%c.%s() Error `%s`\n",n,e,i.reset)};return r?{...s,logProperty:console.debug.bind(console,T+".%s = %o;",n,e,i.reset),logMethod:console.debug.bind(console,T+".%s();",n,e,i.reset),logModule:console.debug.bind(console,T+"/%s.js;",n,e,i.reset),logMethodArgs:console.debug.bind(console,T+".%s(%o);",n,e,i.reset),logMethodFull:console.debug.bind(console,T+".%s(%o) => %o",n,e,i.reset),logOther:console.debug.bind(console,T,n,e,i.reset),incident:b?console.log.bind(console,`${n}🚸
%s${i.reset}.%s() Incident \`%s\` %s!${i.reset}`,e):console.log.bind(console,"%c%s%c.%s() Incident `%s` %s!",n,e,"color: orange;"),time:o=>console.time(e+"."+o+" duration time"),timeEnd:o=>console.timeEnd(e+"."+o+" duration time")}:s};x.registeredList.push({name:"signal",version:"1.0.0"});var p=5,l={},u="eventTarget"in window?new EventTarget:document.createElement("span");function j(e,r=!1){let t=l[e];if(t!=null){for(let n of t.listenerList)u.removeEventListener(e,n.callback);if(r){delete l[e];return}t.listenerList.length=0}}function K(){let e=Object.keys(l);for(let r of e)j(r,!0)}var c=h("context-signal"),L=0,v=()=>e=>{let r=l[e];return r==null&&(r=l[e]={id:e,disabled:!1,debounced:!1,detail:void 0,listenerList:[],firstDispatchedDone:!1}),r},k=()=>(e,r,t=!1)=>{var s;(s=c.logMethodArgs)==null||s.call(c,"setContextSignalValue",{signalId:e,value:r,replaceAll:t});let n=v()(e);return n.detail===void 0||t?(n.detail=r,n):typeof n.detail=="object"&&!Array.isArray(n.detail)&&typeof r=="object"?(n.detail={...n.detail,...r},n):(n.detail=r,n)},B=()=>e=>v()(e).detail;function w(){return(e,r,t={})=>{var o,a,f,d;(o=t.debounce)!=null||(t.debounce="NextCycle"),(a=t.scopeName)!=null||(t.scopeName="unknown"),(f=t.replaceAll)!=null||(t.replaceAll=!1),(d=c.logMethodArgs)==null||d.call(c,"contextDispatch",{signalId:e,value:r,options:t});let n=k()(e,r,t.replaceAll);if(n.firstDispatchedDone=!0,n.disabled)return;let s=()=>{u.dispatchEvent(new CustomEvent(e,{detail:r}))};if(t.debounce==="No"){s();return}if(t.debounce==="NextCycle"){setTimeout(s,0);return}n.debounced!==!0&&(n.debounced=!0,t.debounce==="AnimationFrame"?requestAnimationFrame(s):setTimeout(s,p))}}function z(){return(e,r,t={})=>{var s;if((s=c.logMethodArgs)==null||s.call(c,"contextEditionDispatch",{signalId:e,value:r,options:t}),!v()(e).firstDispatchedDone){console.warn(`Use \`contextDispatch\` for ${e} , then this function can run`);return}w()(e,r,t)}}function N(){return(e,r,t={})=>{var o,a,f;(o=t.preserved)!=null||(t.preserved=!0),(a=c.logMethodArgs)==null||a.call(c,"onContextDispatch",{signalId:e,callback:r,options:t});let n=v()(e);if(n.disabled)return L;let s=d=>{try{r(d.detail)}catch(O){c.error("onContextDispatch","call_signal_callback_failed",O,{signalId:n.id})}};return n.listenerList.push({id:++L,signalId:n.id,once:(f=t.once)!=null?f:!1,callback:s}),u.addEventListener(e,d=>{t.runAsLatest?setTimeout(()=>{s(d)},0):s(d)},{once:t.once}),t.preserved&&n.firstDispatchedDone&&setTimeout(s,0,n.detail),L}}function P(){return(e,r)=>{let t=l[e];if(t==null)return;let n=t.listenerList.findIndex(s=>s.id===r);n>-1&&u.removeEventListener(e,t.listenerList[n].callback)}}function G(){return(e,r)=>{let t=!1;return new Promise(n=>{let s=N()(e,o=>{typeof r=="function"?r(o)===!0&&(t=!0,n()):n(),t&&P()(e,s)})})}}var g=h("simple-signal"),D=0,A=e=>{let r=l[e];return r==null&&(r=l[e]={id:e,disabled:!1,debounced:!1,listenerList:[],firstDispatchedDone:!1}),r};function X(e,r={}){var s,o;(s=r.debounce)!=null||(r.debounce="NextCycle"),(o=g.logMethodArgs)==null||o.call(g,"dispatch",{signalId:e,options:r});let t=A(e);if(t.firstDispatchedDone=!0,t.disabled)return;let n=()=>{u.dispatchEvent(new CustomEvent(e))};if(r.debounce==="No"){n();return}if(r.debounce==="NextCycle"){setTimeout(n,0);return}t.debounced!==!0&&(t.debounced=!0,r.debounce==="AnimationFrame"?requestAnimationFrame(n):setTimeout(n,p))}function R(e,r,t={}){var o,a,f;(o=t.preserved)!=null||(t.preserved=!0),(a=g.logMethodArgs)==null||a.call(g,"onDispatch",{signalId:e,callback:r,options:t});let n=A(e);if(n.disabled)return D;let s=()=>{try{r()}catch(d){g.error("onContextDispatch","call_signal_callback_failed",d,{signalId:n.id})}};return n.listenerList.push({id:++D,signalId:n.id,once:(f=t.once)!=null?f:!1,callback:s}),u.addEventListener(e,()=>{t.runAsLatest?setTimeout(()=>{s()},0):s()},{once:t.once}),t.preserved&&setTimeout(r,0),D}function M(e,r){let t=l[e];if(t==null)return;let n=t.listenerList.findIndex(s=>s.id===r);n>-1&&u.removeEventListener(e,t.listenerList[n].callback)}function Y(e){return new Promise(r=>{let t=R(e,()=>{r(),M(e,t)})})}export{w as contextDispatch,z as contextEditionDispatch,X as dispatch,G as firstContextDispatch,Y as firstDispatch,B as getContextSignalValue,N as onContextDispatch,R as onDispatch,P as removeOnContextDispatch,M as removeOnDispatch,K as resetSignalObject,k as setContextSignalValue};
//# sourceMappingURL=signal.js.map
